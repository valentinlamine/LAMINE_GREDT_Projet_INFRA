<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link type="text/css" rel="stylesheet" href="CSS/header.css">
    <link type="text/css" rel="stylesheet" href="CSS/index.css">
    <title>Documentation d'exploitation</title>
</head>
<body>
    <div class="header">
        <div class="logo">
            <a href="/" class="logo">
            <img src="ASSETS/IMG_HEADER/logo-ynov-aix.png" alt="logo">
            <div class="logo-text">
                <p>Documentation Projet Infra</p>
                <h1>Mathis Gredt et Valentin Lamine</h1>
            </div>
            </a>
        </div>
        <div class="lien">
            <input class="menu-button" type="checkbox" id="menu-button">
            <label for="menu-button">
                <img src="ASSETS/IMG_HEADER/menu.svg" alt="menu" class="burger">
                <img src="ASSETS/IMG_HEADER/close.svg" alt="close" class="close">
            </label>
            <nav class="menu">
                <ul>
                    <li><a href="index.html">architecture</a></li>
                    <li><a href="Exploitation.html">Exploitation</a></li>
                </ul>
            </nav>
        </div>
    </div>
    <div class="content">
        <div class="First-container">
            <p>Le projet consiste à mettre en place un système d'information (SI) pour une petite entreprise en utilisant des machines virtuelles (VMs) interconnectées via un switch ou wifi. L'architecture proposée comprend un pare-feu avec DHCP, DNS, filtrage réseau et routage, deux clients (1 Windows et 1 Linux), un serveur Linux pour la sauvegarde du site web et un autre serveur Linux pour l'hébergement du site web.</p><br>
            <p>L'accès au serveur de sauvegarde se fera uniquement via le réseau interne de l'entreprise, tandis que l'accès au site web sera possible depuis le réseau internet ou externe.</p><br>
            <p>Les livrables attendus incluent un rapport de projet faisant état des solutions techniques et transverses mises en œuvre, une documentation d'architecture détaillant la mise en œuvre des bonnes pratiques et les configurations nécessaires pour mettre en place la solution, ainsi qu'une documentation d'exploitation détaillant l'utilisation des outils et services mis en place et les procédures de sauvegarde et de restauration du site web.</p><br>
            <p>L'évaluation du projet se fera à travers une évaluation intermédiaire, une présentation finale sous forme de démonstration pour l'ensemble du projet, ainsi que des livrables (documentation et code) pour chaque partie du projet. Le projet inclut également des bonus tels que la mise en place d'un certificat auto-signé ou signé et l'explication de celui-ci sur le site web.</p><br>
        </div>
        <div class="Second-container">
            <h1>I. Introduction</h1>
            <p>L'objectif de cette documentation est de présenter l'utilisation des outils et services mis en place dans le cadre du Projet Infra. Elle permettra aux utilisateurs et administrateurs de comprendre comment utiliser les différents outils et services du réseau.</p>
        </div>
        <div class="Third-container">
            <h1>II. Utilisation des outils/services</h1>
                <p>
                    Gestion des fichiers et des dossiers<br>
                    Attribution des droits d'accès aux différents services<br>
                    Sauvegarde et restauration des ressources web<br>
                    Procédure de sauvegarde des ressources web<br>
                    Planification des sauvegardes<br>
                    Procédure de restauration des ressources web à partir de la sauvegarde<br>
                </p>
        </div>
        <div class="Fourth-container">
            <h1>III. Sauvegarde des ressources web</h1>
            <div class="categorie">
                <h2>1. Procédure de sauvegarde</h2> 
                    <p>Pour les backups nous avons décidé de nous tourner vers rsync car il y a beaucoup de ressource sur internet expliquant son utilisation.</p><br>
                    <p>Nous avons donc commencé en préparant les deux serveurs mon but sera de sauvegarder le dossier "var/www/"" du serveur web vers le dossier "var/web-server-backups/" sur le serveur de sauvegarde</p><br>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Procedure_sauvegarde/preparation_serveur.png">
                    <p>nous avons par la suite pour être sûr d’éviter les problèmes de permissions fait du compte sauvegarde-web le propriétaire du dossier web-server-backups :</p> <!-- il manque une commande ici -->
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Procedure_sauvegarde/permissions.png">
                <h2>2. Emplacement de stockage des sauvegardes</h2>
                    <p>Vient en suite le moment de tester la commande de sauvegarde: <br>
                    "rsync --dry-run -avz /var/www/ sauvegarde-web192.168.159.129:/var/web-server-backups/<br> 
                    qui se décompose en plusieurs parties : </p><br>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Stockage_sauvegarde/test_commande.png">
                    <p>
                    -	Tout d’abord nous avons rsync qui est la commande pour la sauvegarde<br>
                    -	Nous utilisons ensuite –dry-run pour tester la commande, cet argument simulera le déplacement de fichier sans réellement l’effectuer<br>
                    -	Nous avons ensuite l'options -avz<br>
                    -	Nous choisissons ensuite le dossier que nous souhaitons sauvegarder «/var/www/»<br>
                    -	Puis enfin l’endroit où nous le sauvegardons :<br>
                        o	Sur l’utilisateur "sauvegarde-web"<br>
                        o	A l’adresse IP "192.168.159.129" (configuration réseau pas à jour)<br>
                        o	Dans le dossier "/var/web-server-backups/"<br>
                    </p>
                    <p>On nous demande ensuite si nous voulons établir la connexion</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Stockage_sauvegarde/connexion.png">
                    <p>Puis le mot de passe du compte</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Stockage_sauvegarde/mdp.png"><br>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Stockage_sauvegarde/result_commande.png"><br>
                    <p>Nous voyons donc que la commande fonctionne bien à noter que nous somme en dry run et que les fichiers n’ont pas été transféré</p><br>
                    <p>Maintenant que nous voyons que la commande semble bonne nous la testons réellement en enlevantla "--dry-run":<br>
                    "rsync -avz /var/www/ sauvegarde-web192.168.159.129:/var/web-server-backups/"</p><br>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Stockage_sauvegarde/test_vrai_commande.png"><br>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Stockage_sauvegarde/test_vrai_commande2.png"><br>
                    <p>Nous voyons donc que le transfert à bien été effectué sur la deuxième capture</p> 
                    <p>Maintenant que nous voyons que notre transfert est fonctionnel nous allons l’améliorer, on vide la sauvegarde en allant quand le dossier des sauvegarde et en utilisant la commande: "rm -rf *"</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Stockage_sauvegarde/supr_sauvegarde.png"><br>
                <h2>3. Methode de sauvegarde</h2>
                    <p>Nous allons créer un script pour exécuter cette commande en automatique, pour se faire nous utilisons echo:</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Methode_sauvegarde/rsync.png"><br>
                    <p>Nous modifions ensuite notre script : </p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Methode_sauvegarde/modif_script.png"><br>
                    <p>Tout d’abord nous précisons avec le # à pour but d’être exécuté sur le bash</p><br>
                <h2>4. Planification des sauvegardes</h2>
                    <p>Puis nous créons la variable date qui utilise la commande date nous renvoyons la date du jour</p><br>
                    <p>Nous modifions ensuite notre commande pour qu’elle crée la backup chaque jour dans un dossier ayant pour nom la date actuelle</p><br>
                    <p>Nous ajoutons ensuite des permissions d’exécutions à notre script avec la commande "chmod +x nackup.sh"</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Planification_sauvegarde/permission.png"><br>
                <h2>5. Vérification des sauvegardes</h2>
                    <p>Nous allons maintenant tester notre script</p>
                    <p>Dossier de sauvegarde avant sauvegarde</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Verification_sauvegarde/avant_sauvegarde.png"><br>
                    <p>Lancement de la sauvegarde</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Verification_sauvegarde/sauvegarde.png"><br>
                    <p>Dossier de sauvegarde après sauvegarde</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Verification_sauvegarde/apres_sauvegarde.png"><br>
                    <p>Nous voyons donc que la sauvegarde à bien été effectué</p>
                <h2>6. Problèmes</h2>
                    <p> Même si la sauvegarde fonctionne correctement il y a encore 2 problèmes</p>
                    <p>
                        -	La commande nous demande à chaque fois le mot de passe<br>
                        -	La commande ne s’exécute pas automatiquement<br>
                    </p>
                    <p>Commençons par le mot de passe</p><br>
                    <p>Notre problème réside dans l’authentification ssh, il faut donc mettre en place un système d’authentification par clé</p><br>
                    <p>Nous commençons par générer une clé sur le serveur web avec la commande: "ssh-keygen -b 4096"</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Problèmes/generation_clef.png"><br>
                    <p>Nous générons la clé donc avec 4096 bits afin de respecter les bonnes pratiques et nous lui donnons une paraphrase sauvegarde</p><br>
                    <p>Maintenant nous copions l’Id du serveur avec la commande "ssh-copy-id sauvegarde-web@192.168.1.66"</p>
                    <img src="ASSETS/IMG_EXPLOITATION/Partie3/Problèmes/copie_id.png"><br>
                    <p>Une fois faits-nous pouvons-nous connecter directement à notre ssh sans mot de passe</p>
                <h2>7. Sauvegarde automatique</h2>
                    <p>PAssons maintenant au deuxième problème</p>
                    <p>Pour la sauvegarde automatique nous allons l’ajouter à la liste des programmes automatiques pour ce faire nous tapons la commande "crontab -e"<br>
                        puis nous ajoutons la ligne "0 12 * * * /bin/bash /var/backup.sh"</p>
                        <img src="ASSETS/IMG_EXPLOITATION/Partie3/Sauvegarde_automatique/sauvegarde_auto.png"><br>
                    <p>Cette ligne permet de lancer grâce au bash le cript backup.sh tout les jour à 12h</p>
            </div>
            <p>
                Tests de restauration à partir des sauvegardes<br>
            </p>
        </div>
        <div class="Fifth-container">
            <h1>IV. Restauration à une date antérieure du site web</h1>
            <p>
                Sélection de la sauvegarde à restaurer<br>
                Planification de la restauration<br>
                Restauration à partir de la sauvegarde<br>
                Vérification de la restauration<br>
        </div>
        <div class="conclusion">
            <p>
                En conclusion, cette documentation d'exploitation permettra aux utilisateurs et administrateurs de comprendre comment utiliser les différents outils et services du réseau, ainsi que les procédures de sauvegarde et de restauration des ressources web. 
                Elle est indispensable pour assurer la continuité des activités dans le cadre du Porjet Infra.
            </p>
        </div>
    </div>
</body>
</html>